<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:LBGScore.ViewModels"
             x:Class="LBGScore.Views.LiveMatchPage"
             Title="Partido en Vivo">

    <ContentPage.BindingContext>
        <viewmodels:LiveMatchViewModel />
    </ContentPage.BindingContext>

    <!-- Grid principal: 70% arriba (partido), 30% abajo (carrusel) -->
    <Grid RowDefinitions="7*,3*" Padding="15" RowSpacing="12">

        <!-- ======================================================
             SECCIÓN 70% - PARTIDO (fija, sin ScrollView)
             - Si HasMatch = false muestra mensaje central
             - Si HasMatch = true muestra tarjeta con diseño limpio
             ====================================================== -->
        <Grid Grid.Row="0">

            <!-- Mensaje cuando NO hay partido -->
            <Label Text="No hay ningún partido en juego"
                   FontSize="20"
                   TextColor="#666"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   IsVisible="False">
                <Label.Triggers>
                    <DataTrigger TargetType="Label" Binding="{Binding HasMatch}" Value="False">
                        <Setter Property="IsVisible" Value="True" />
                    </DataTrigger>
                </Label.Triggers>
            </Label>

            <!-- Tarjeta del partido (visible solo si HasMatch == true) -->
            <Frame IsVisible="{Binding HasMatch}"
                   CornerRadius="14"
                   Padding="12"
                   Margin="0,0,0,6"
                   BackgroundColor="White"
                   HasShadow="True">

                <VerticalStackLayout Spacing="12">

                    <!-- Fecha + Hora -->
                    <StackLayout HorizontalOptions="Center" Spacing="2">
                        <Label Text="{Binding Match.Dia}" FontSize="14" TextColor="#666" HorizontalOptions="Center"/>
                        <Label Text="{Binding Match.Hora}" FontSize="20" FontAttributes="Bold" HorizontalOptions="Center"/>
                    </StackLayout>

                    <!-- FILA: Logos + Resultados (resultado junto al logo) -->
                    <Grid ColumnDefinitions="*,Auto,*" VerticalOptions="Center" Padding="6">
                        <!-- Columna izquierda: Logo local + score al lado derecho del logo -->
                        <Grid Grid.Column="0" HorizontalOptions="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Logo local -->
                            <Image Grid.Column="0"
                                   Source="{Binding Match.LogoL}"
                                   HeightRequest="72"
                                   WidthRequest="72"
                                   Aspect="AspectFit"
                                   HorizontalOptions="Center"/>

                            <!-- Score local junto al logo -->
                            <Label Grid.Column="1"
                                   Text="{Binding Match.GolesLocal}"
                                   FontSize="36"
                                   FontAttributes="Bold"
                                   VerticalTextAlignment="Center"
                                   HorizontalOptions="Start"
                                   Margin="16,0,0,0"/>
                        </Grid>

                        <!-- Columna central: separador visual (puede ser ":" o espacio) -->
                        <Label Grid.Column="1"
                               Text=":"
                               FontSize="32"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>

                        <!-- Columna derecha: score visitante + logo visitante -->
                        <Grid Grid.Column="2" HorizontalOptions="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Score visitante (antes del logo para simetría) -->
                            <Label Grid.Column="0"
                                   Text="{Binding Match.GolesVisitante}"
                                   FontSize="36"
                                   FontAttributes="Bold"
                                   VerticalTextAlignment="Center"
                                   HorizontalOptions="End"
                                   Margin="0,0,16,0"/>

                            <!-- Logo visitante -->
                            <Image Grid.Column="1"
                                   Source="{Binding Match.LogoV}"
                                   HeightRequest="72"
                                   WidthRequest="72"
                                   Aspect="AspectFit"
                                   HorizontalOptions="Center"/>
                        </Grid>
                    </Grid>

                    <!-- Nombres debajo de cada logo (alineados con las columnas) -->
                    <Grid ColumnDefinitions="*,Auto,*" Padding="6">
                        <Label Grid.Column="0"
                               Text="{Binding Match.Local}"
                               FontSize="16"
                               HorizontalOptions="Center"
                               HorizontalTextAlignment="Center"/>
                        <Label Grid.Column="1" Text="" />
                        <!-- espacio central -->
                        <Label Grid.Column="2"
                               Text="{Binding Match.Visitante}"
                               FontSize="16"
                               HorizontalOptions="Center"
                               HorizontalTextAlignment="Center"/>
                    </Grid>

                    <!-- Estado etiqueta (centrada) -->
                    <!--<Frame Padding="8,4"
                           CornerRadius="10"
                           BackgroundColor="{Binding Match.EstadoColorHex}"
                           HorizontalOptions="Center">
                        <Label Text="{Binding Match.EstadoTexto}"
                               TextColor="White"
                               FontSize="14"
                               FontAttributes="Bold" />
                    </Frame>-->

                    <!-- Tiempo / Minuto -->
                    <Label Text="{Binding Match.Tiempo}"
                           FontSize="28"
                           FontAttributes="Bold"
                           TextColor="#E53935"
                           HorizontalOptions="Center" />

                    <!-- Línea final: Categoría y Vocal (ligeramente separadas) -->
                    <HorizontalStackLayout HorizontalOptions="Center" Spacing="18">
                        <StackLayout Orientation="Horizontal" Spacing="6" HorizontalOptions="Center">
                            <Label Text="Categoría:" FontSize="13" TextColor="#666"/>
                            <Label Text="{Binding Match.Categoria}" FontSize="13" FontAttributes="Bold"/>
                        </StackLayout>

                        <!--<StackLayout Orientation="Horizontal" Spacing="6" HorizontalOptions="Center">
                            <Label Text="Vocal:" FontSize="13" TextColor="#666"/>
                            <Label Text="{Binding Match.Vocal}" FontSize="13" FontAttributes="Bold"/>
                        </StackLayout>-->
                    </HorizontalStackLayout>

                </VerticalStackLayout>
            </Frame>
        </Grid>

        <!-- ======================================================
             SECCIÓN 30% - CARRUSEL (un solo banner visible)
             - Espacio entre frame y carrusel provisto por RowSpacing y Margins
             ====================================================== -->
        <VerticalStackLayout Grid.Row="1" Spacing="6">

            <!--<Label Text="Auspiciantes"
                   FontSize="18"
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />-->

            <!-- CarouselView (exactamente como lo tenías) -->
            <CarouselView ItemsSource="{Binding Auspiciantes}"
                          Position="{Binding CarouselPosition}"
                          HeightRequest="160"
                          Loop="True"
                          HorizontalOptions="FillAndExpand"
                          VerticalOptions="FillAndExpand"
                          IsSwipeEnabled="False">

                <CarouselView.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Image Source="{Binding BannerUrl}"
                                   Aspect="AspectFit" />
                        </Grid>
                    </DataTemplate>
                </CarouselView.ItemTemplate>
            </CarouselView>

            <IndicatorView x:Name="ind"
                           IndicatorColor="#CCCCCC"
                           SelectedIndicatorColor="#333333"
                           HorizontalOptions="Center"
                           Margin="0,6,0,0" />

        </VerticalStackLayout>

    </Grid>
</ContentPage>
